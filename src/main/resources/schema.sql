CREATE TABLE IF NOT EXISTS MPA_RATINGS (
	MPA_RATING_ID_PK INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	MPA_RATING_NAME VARCHAR(50) NOT NULL UNIQUE
);

CREATE TABLE IF NOT EXISTS FILMS (
	FILM_ID_PK INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
	FILM_NAME VARCHAR(255) NOT NULL,
	FILM_RELEASE_DATE DATE NOT NULL,
	FILM_DURATION INTEGER NOT NULL,
	FILM_MPA_RATING_FK INTEGER NOT NULL REFERENCES MPA_RATINGS(MPA_RATING_ID_PK),
	FILM_DESCRIPTION VARCHAR(200) NOT NULL
);

CREATE TABLE IF NOT EXISTS GENRES (
	GENRE_ID_PK INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
	GENRE_NAME VARCHAR(50) NOT NULL UNIQUE
);

CREATE TABLE IF NOT EXISTS FILMS_GENRES (
	FG_FILM_ID INTEGER NOT NULL REFERENCES FILMS(FILM_ID_PK),
	FG_GENRE_ID INTEGER NOT NULL REFERENCES GENRES(GENRE_ID_PK),
	CONSTRAINT FILM_GENRE_PK PRIMARY KEY (
		FG_FILM_ID,
		FG_GENRE_ID
	)
);

CREATE TABLE IF NOT EXISTS USERS (
	USER_ID_PK INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
	USER_LOGIN VARCHAR(255) NOT NULL UNIQUE,
	USER_NAME VARCHAR(255) NOT NULL,
	USER_EMAIL VARCHAR(255) NOT NULL UNIQUE,
	USER_BIRTHDAY DATE NOT NULL
);

CREATE TABLE IF NOT EXISTS FILMS_RATINGS (
	FR_FILM_ID_PK INTEGER NOT NULL REFERENCES FILMS(FILM_ID_PK),
	FR_USER_ID_PK INTEGER NOT NULL REFERENCES USERS(USER_ID_PK),
	CONSTRAINT FILMS_RATING_PK PRIMARY KEY(
		FR_USER_ID_PK,
		FR_FILM_ID_PK
	)
);

CREATE TABLE IF NOT EXISTS FRIENDSHIP_STATUSES (
	FS_USER_ID INTEGER NOT NULL REFERENCES USERS(USER_ID_PK),
	FS_FRIEND_ID INTEGER NOT NULL REFERENCES USERS(USER_ID_PK),
	CONSTRAINT FRIENDSHIP_STATUS_PK PRIMARY KEY(
		FS_FRIEND_ID,
		FS_USER_ID
	)
);

